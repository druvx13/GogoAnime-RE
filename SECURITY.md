# Security

**OFFICIAL DOCUMENTATION**

## 1. Authentication Model
The system uses a standard session-based authentication mechanism.
-   **Storage:** User credentials (email/password) are stored in the `users` table.
-   **Hashing:** Passwords must be hashed. The specific algorithm depends on the PHP version and implementation (typically `password_hash` / `bcrypt`).
-   **Sessions:** PHP native sessions track logged-in state (`$_SESSION`).

## 2. Authorization (RBAC)
Role-Based Access Control is implemented via the `role` column in the `users` table.
-   **User:** Can browse, watch, bookmark, and comment.
-   **Admin:** Has full access to the `/admin` directory and all CRUD operations.
-   **Enforcement:**
    -   Frontend: Checks logic in navigation bars (e.g., "Show Admin Link if role == admin").
    -   Backend: `admin/auth.php` is included at the top of every sensitive script to redirect unauthorized users.

## 3. Data Protection
-   **SQL Injection:** All database queries utilizing user input must use PDO Prepared Statements.
-   **XSS (Cross-Site Scripting):** Output echoing user content (like comments) must be escaped using `htmlspecialchars()` or equivalent.
-   **CSRF (Cross-Site Request Forgery):** State-changing forms (POST requests) should include a CSRF token generated by `app/config/csrf.php`.

## 4. Known Risks & Limitations
-   **Session Hijacking:** No built-in IP binding for sessions; relies on HTTPS for transport security.
-   **Brute Force:** No built-in rate limiting on login forms. Recommended to implement at the web server level (e.g., `fail2ban`).
-   **File Uploads:** Admin uploads are placed in `assets/uploads`. Ensure the web server is configured to prevent executing scripts (e.g., `.php`) in this directory.

## 5. Security Checklist for Operators
1.  **Change Default Credentials:** Ensure no default admin accounts remain.
2.  **Enable HTTPS:** Mandatory for production.
3.  **Hide Errors:** Set `display_errors = Off` in production.
4.  **Restrict Database:** Ensure the database user has only necessary privileges.
